<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      label {
        display: block;
        margin-top: 10px;
        font-weight: bold;
      }
      input, select, textarea {
        width: 100%;
        padding: 6px;
        margin-top: 4px;
        box-sizing: border-box;
      }
      button {
        margin-top: 20px;
        padding: 10px;
        width: 100%;
        background-color: #1a73e8;
        color: white;
        border: none;
        font-size: 16px;
        cursor: pointer;
      }
      button:hover {
        background-color: #0c55c3;
      }
    </style>
  </head>
  <body>
    <h2>Registro de Gasto</h2>

    <form id="formulario">
      <label for="categoria">Categoría</label>
      <select id="categoria" required>
        <option value="Compra de mercadería">Compra de mercadería</option>
        <option value="Compra de insumos">Compra de insumos</option>
        <option value="Sueldos u honorarios">Sueldos u honorarios</option>
        <option value="Logística">Logística</option>
        <option value="Impuestos">Impuestos</option>
        <option value="Publicidad">Publicidad</option>
        <option value="Página Web">Página Web</option>
        <option value="Suscripciones">Suscripciones</option>
        <option value="Envíos">Envíos</option>
        <option value="Otros">Otros</option>
      </select>

      <label for="descripcion">Descripción</label>
      <textarea id="descripcion" rows="2" required></textarea>

      <label for="monto">Monto ($)</label>
      <input type="number" id="monto" required min="1" step="any">

      <label for="tipoGasto">Tipo de Gasto</label>
      <select id="tipoGasto" required>
        <option value="Fijo">Fijo</option>
        <option value="Variable">Variable</option>
      </select>

      <label for="proveedor">Proveedor</label>
      <input type="text" id="proveedor">

      <label for="nota">Documento</label>
      <select id="nota">
        <option value="Factura">Factura</option>
        <option value="Boleta">Boleta</option>
        <option value="Boleta de Honorarios">Boleta de Honorarios</option>
      </select>

      <button type="button" onclick="enviarFormulario()">Registrar Gasto</button>
    </form>

    <script>
      function enviarFormulario() {
        const data = {
          categoria: document.getElementById("categoria").value,
          descripcion: document.getElementById("descripcion").value.trim(),
          monto: parseFloat(document.getElementById("monto").value),
          tipoGasto: document.getElementById("tipoGasto").value,
          proveedor: document.getElementById("proveedor").value.trim(),
          nota: document.getElementById("nota").value
        };

        if (!data.descripcion || isNaN(data.monto)) {
          alert("Por favor completa correctamente los campos obligatorios.");
          return;
        }

        google.script.run
          .withSuccessHandler(() => {
            alert("Gasto registrado correctamente.");
            google.script.host.close();
          })
          .registrarGasto(data);
      }
    </script>
  </body>
</html>
